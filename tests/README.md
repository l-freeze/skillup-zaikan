# テストについて

### リファクタリング容易性を高めるためにテストを書く事を意識する

- Unitディレクトリはアプリケーション層のテストケースを書く
- ドメインロジックが複雑な場合はそのロジックのみテストケースを書く
  - 全てのドメインロジックのテストを書くとリファクタリング容易性を損なう為書いてはいけない

### DBを使うテストについては本番相当の環境を使う

- 本番環境とテスト実施時の環境が異なるとテストが意味を成さない
  - それどころかテストを通す為に本番環境のコードを修正が必要なケースがあり、そこで踏み止まれない事情がある場合にテストの為にソースを破壊する事になる
  - テストデータはテストケース毎に用意する
    - テストデータの変更が他のテストに影響を与える可能性がある為
      - ただし、テストが遅くなる場合はテストデータを共有するように慎重に調整する事は許容する

### テストケースひとつひとつの可読性を重視する

- 冗長なテストケースがある事よりも、可読性の悪いテストケースが並ぶ事を忌避する
  - テストケースの可読性が悪いとテストの修正や追加が困難になる
  - テストケースの可読性を高める為には、テストデータの変更に強いテストケースを書く事が重要
    - 例えば、DataProviderを使わない
      - phpdocがプログラムの挙動に影響を与える事など以ての外
    - 代替策としてpestのwithを使う
      - ただしこの場合でもwithを用いる為だけにテストケースが読み辛くなるのであればwithを使わない
